# [Atomic configuration state functions (CSFs)](@id CSFs)

AtomicLevels also provides types to represent symmetry-adapted atomic states, commonly referred to as [configuration state functions (CSFs)](https://en.wikipedia.org/wiki/Configuration_state_function). These are linear combinations of Slater determinants arising from a particular _configuration_, that are also
eigenstates of the angular momentum.

## Background

When constructing a basis for many-body atomic states, you start from a set of single-particle states (orbitals) and form anti-symmetric many-particle product states (Slater determinants) of any particle number. Superpositions of these Slater determinants can then represent full many-electron wavefunctions. In principle, if the set of one-particle orbitals is complete, the set of all Slater determinants would form a complete many-particle basis.

However, even if your orbitals are angular momentum eigenstates, the Slater determinants formed out of these orbitals in general are not. As angular momentum symmetry is a useful symmetry to adhere to when working with atomic states, this is where CSFs come in. They form a _symmetry adapted_ many body basis, representing the same many-particle space, but each state is now also an eigenstate of angular momentum. They are related to the underlying Slater determinats via a basis transformation.

!!! note "Other symmetries"

    You can also imagine CSFs that are adapted to other symmetries. However, at this stage, AtomicLevels only supports CSFs adapted to angular momentum.

### Forming a CSF

In AtomicLevels, CSFs are represented with the [`CSF`](@ref) type. An instance of a [`CSF`](@ref) only specifies the CSFs up to the total angular momentum (i.e. it actually represent a set of states corresponding to the different possible ``J_z`` quantum numbers).

The starting point for a CSF is a configuration, i.e. a list of orbitals and their occupations (how many electrons in the orbital). Each configuration corresponds to a set of Slater determinants, generated by considering all the possible combinations of `m` quantum numbers of the orbitals.

The next step is to couple each subshell into angular momentum eigenstates. This is, in principle, similar to how you can use the Clebch-Gordan coefficients to couple products states of angular momentum states together into angular momentum eigen states:

```
CG example expression for generic j1, j2, j3
```

However, you have to account for the fact that due to the anti-symmetry of fermionic many-particle states, only a subset of products are valid or unique many-electron states. Hence, determining the resulting ``J`` (or ``L``/``S``) eigenvalues and the coupling coefficients is non-trivial.

```
Example with generating subshell terms.
```

Furthermore, it turns out if you go to high enough angular momenta of the orbital and high enough particle number, the angular momentum eigenvalues are no longer sufficient to uniquely identify coupled states.

```
Example with generating subshell terms.
```

Hence an additional quantum number is required to keep track of that. Often a _seniority_ quantum number, corresponding to a specific operator, is used`TODO: reference?`. But even that is not generic. In AtomicLevels, we just note the multiplicity of the space and use an integer to keep track of the states, leaving the interpretation up to the user.

Finally, once the subshells are coupled, we can couple the subshells together. As the orbitals in a subshell are distinct from the ones in other subshells, this can easily be done with just Clebch-Gordan coefficients.

In AtomicLevels, we assume that the coupling is done by starting from the leftmost orbital pair, coupling those subshells together. Then the coupled two subshells are taken and coupled to the next subshells, and so on. In the end, we get a coupling tree that looks something like this:

```
IMAGE OF SUBSHELL COUPLING
```

The total angular momenta of the last coupling determines the angular momentum of the whole CSFs.

---

orbital angular momentum ``\hat{L}``, spin angular momentum ``\hat{S}`` and the total angular momentum ``\hat{J} = \hat{L} + \hat{S}``

orbital ``\hat{L}^2`` and ``\hat{S}^2``

final states are eigenfunctions of

``\hat{J}^2``

Given two sets of

```math
\ket{\alpha\beta; j, m} = C() \ket{\alpha}
```

futhermore, as the `S` and the `L` spaces are orthogonal,
you can simultaneously

First, each subshell

* The ordering of the configuration is significant.
* First, couple each subshell. Note, in general you end up with non-unique states. Hence, we actually need to also keep

As these states do not appear to be distinguishable by any fundamental symmetry,

---

## Coupling schemes

How the coupling of orbitals into CSFs

AtomicLevels currently supports representing CSFs in the following two schemes:

### ``LS``-coupling

In ``LS``-coupling, each orbital must be a of [`Orbital`](@ref), specified by its ``n`` and ``\ell`` quantum numbers. Implicitly, each orbital also has a spin values of ``s = 1/2``.

When coupling is performed, the ``L`` and ``S`` spaces are coupled separately. This is possible because the spaces are orthogonal.

This means that each subshell term is represented by an ``L`` and ``S`` values, together with the seniority number. Intra-subshell couplings are defined by the ``L`` and ``S`` values.

The final CSF in ``LS``-coupling does not define a ``J`` value, i.e. AtomicLevels currently does not perform ``LSJ``-coupling.

### ``jj``-coupling

``jj``-coupling is used for [`RelativisticOrbital`](@ref)s, where each orbital
only has the total angular momentum value ``J``. In this coupling scheme, only the ``J`` values coupled. Intermediate terms are the ``J`` values, together with seniority, and the intra-shell couplings are determined according to the ``J`` value.

## Reference

```@docs
CSF
```
