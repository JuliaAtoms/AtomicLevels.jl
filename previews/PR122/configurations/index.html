<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Configurations · AtomicLevels</title><meta name="title" content="Configurations · AtomicLevels"/><meta property="og:title" content="Configurations · AtomicLevels"/><meta property="twitter:title" content="Configurations · AtomicLevels"/><meta name="description" content="Documentation for AtomicLevels."/><meta property="og:description" content="Documentation for AtomicLevels."/><meta property="twitter:description" content="Documentation for AtomicLevels."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AtomicLevels</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../orbitals/">Orbitals</a></li><li class="is-active"><a class="tocitem" href>Configurations</a><ul class="internal"><li><a class="tocitem" href="#Interface"><span>Interface</span></a></li><li><a class="tocitem" href="#Generating-configuration-lists"><span>Generating configuration lists</span></a></li><li><a class="tocitem" href="#Spin-configurations"><span>Spin configurations</span></a></li><li><a class="tocitem" href="#Excited-configurations"><span>Excited configurations</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li><li><a class="tocitem" href="../terms/">Term symbols</a></li><li><a class="tocitem" href="../csfs/">CSFs</a></li><li><a class="tocitem" href="../utilities/">Other utilities</a></li><li><a class="tocitem" href="../internals/">Internals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Configurations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Configurations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaAtoms/AtomicLevels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/master/docs/src/configurations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="man-configurations"><a class="docs-heading-anchor" href="#man-configurations">Atomic configurations</a><a id="man-configurations-1"></a><a class="docs-heading-anchor-permalink" href="#man-configurations" title="Permalink"></a></h1><p>We define a configuration to be a set of orbitals with their associated occupation (i.e. the number of electron on that orbital). We can represent a particular configuration with an instance of the <a href="#AtomicLevels.Configuration"><code>Configuration</code></a> type. The orbitals of a configuration can be unsorted (default) or sorted according to the canonical ordering (first by <span>$n$</span>, then by <span>$\ell$</span>, &amp;c). It is important to allow for arbitrary order, since permutation of the orbitals in a configuration, in general incurs a phase shift of matrix elements, &amp;c.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.Configuration" href="#AtomicLevels.Configuration"><code>AtomicLevels.Configuration</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Configuration{&lt;:AbstractOrbital}</code></pre><p>Represents a configuration – a set of orbitals and their associated occupation number.  Furthermore, each orbital can be in one of the following <em>states</em>: <code>:open</code>, <code>:closed</code> or <code>:inactive</code>.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">Configuration(orbitals :: Vector{&lt;:AbstractOrbital},
              occupancy :: Vector{Int},
              states :: Vector{Symbol}
              [; sorted=false])

Configuration(orbitals :: Vector{Tuple{&lt;:AbstractOrbital, Int, Symbol}}
              [; sorted=false])</code></pre><p>In the first case, the parameters of each orbital have to be passed as separate vectors, and the orbitals and occupancy have to be of the same length. The <code>states</code> vector can be shorter and then the latter orbitals that were not explicitly specified by <code>states</code> are assumed to be <code>:open</code>.</p><p>The second constructor allows you to pass a vector of tuples instead, where each tuple is a triplet <code>(orbital :: AbstractOrbital, occupancy :: Int, state :: Symbol)</code> corresponding to each orbital.</p><p>In all cases, all the orbitals have to be distinct. The orbitals in the configuration will be sorted (if <code>sorted</code>) according to the ordering defined for the particular <a href="../orbitals/#AtomicLevels.AbstractOrbital"><code>AbstractOrbital</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1-L31">source</a></section></article><p>The <a href="#AtomicLevels.@c_str"><code>@c_str</code></a> and <a href="#AtomicLevels.@rc_str"><code>@rc_str</code></a> string macros can be used to conveniently construct configurations:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.@c_str" href="#AtomicLevels.@c_str"><code>AtomicLevels.@c_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@c_str -&gt; Configuration{Orbital}</code></pre><p>Construct a <a href="#AtomicLevels.Configuration"><code>Configuration</code></a>, representing a non-relativistic configuration, out of a string. With the added string macro suffix <code>s</code>, the configuration is sorted.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c&quot;1s2 2s&quot;
1s² 2s

julia&gt; c&quot;1s² 2s&quot;
1s² 2s

julia&gt; c&quot;1s2.2s&quot;
1s² 2s

julia&gt; c&quot;[Kr] 4d10 5s2 4f2&quot;
[Kr]ᶜ 4d¹⁰ 5s² 4f²

julia&gt; c&quot;[Kr] 4d10 5s2 4f2&quot;s
[Kr]ᶜ 4d¹⁰ 4f² 5s²</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L378-L403">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.@rc_str" href="#AtomicLevels.@rc_str"><code>AtomicLevels.@rc_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@rc_str -&gt; Configuration{RelativisticOrbital}</code></pre><p>Construct a <a href="#AtomicLevels.Configuration"><code>Configuration</code></a> representing a relativistic configuration out of a string. With the added string macro suffix <code>s</code>, the configuration is sorted.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; rc&quot;[Ne] 3s 3p- 3p&quot;
[Ne]ᶜ 3s 3p- 3p

julia&gt; rc&quot;[Ne] 3s 3p-2 3p4&quot;
[Ne]ᶜ 3s 3p-² 3p⁴

julia&gt; rc&quot;[Ne] 3s 3p-² 3p⁴&quot;
[Ne]ᶜ 3s 3p-² 3p⁴

julia&gt; rc&quot;2p- 1s&quot;s
1s 2p-</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L408-L430">source</a></section></article><h2 id="Interface"><a class="docs-heading-anchor" href="#Interface">Interface</a><a id="Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Interface" title="Permalink"></a></h2><p>For example, it is possible to index into a configuration, including with a range of indices, returning a sub-configuration consisting of only those orbitals. With an integer index, an <code>(orbital, occupancy, state)</code> tuple is returned.</p><pre><code class="language-julia-repl hljs">julia&gt; config = c&quot;1s2c 2si 2p3&quot;
[He]ᶜ 2sⁱ 2p³

julia&gt; config[2]
(2s, 1, :inactive)

julia&gt; config[1:2]
[He]ᶜ 2sⁱ

julia&gt; config[[3,1]]
[He]ᶜ 2p³</code></pre><p>The configuration can also be iterated over. Each item is a <code>(orbital, occupancy, state)</code> tuple.</p><pre><code class="language-julia-repl hljs">julia&gt; for (o, nelec, s) in config
           @show o, nelec, s
       end
(o, nelec, s) = (1s, 2, :closed)
(o, nelec, s) = (2s, 1, :inactive)
(o, nelec, s) = (2p, 3, :open)</code></pre><p>Various other methods exist to manipulate or transform configurations or to query them for information.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.issimilar" href="#AtomicLevels.issimilar"><code>AtomicLevels.issimilar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">issimilar(a::Configuration, b::Configuration)</code></pre><p>Compares the electronic configurations <code>a</code> and <code>b</code>, only considering the constituent orbitals and their occupancy, but disregarding their ordering and states (<code>:open</code>, <code>:closed</code>, &amp;c).</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; a = c&quot;1s 2s&quot;
1s 2s

julia&gt; b = c&quot;2si 1s&quot;
2sⁱ 1s

julia&gt; issimilar(a, b)
true

julia&gt; a==b
false</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L139-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:==-Union{Tuple{O}, Tuple{Configuration{&lt;:O}, Configuration{&lt;:O}}} where O&lt;:AbstractOrbital" href="#Base.:==-Union{Tuple{O}, Tuple{Configuration{&lt;:O}, Configuration{&lt;:O}}} where O&lt;:AbstractOrbital"><code>Base.:==</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">==(a::Configuration, b::Configuration)</code></pre><p>Tests if configurations <code>a</code> and <code>b</code> are the same, considering orbital occupancy, ordering, and states.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c&quot;1s 2s&quot; == c&quot;1s 2s&quot;
true

julia&gt; c&quot;1s 2s&quot; == c&quot;1s 2si&quot;
false

julia&gt; c&quot;1s 2s&quot; == c&quot;2s 1s&quot;
false</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L169-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.num_electrons-Tuple{Configuration}" href="#AtomicLevels.num_electrons-Tuple{Configuration}"><code>AtomicLevels.num_electrons</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">num_electrons(c::Configuration) -&gt; Int</code></pre><p>Return the number of electrons in the configuration.</p><pre><code class="language-julia-repl hljs">julia&gt; num_electrons(c&quot;1s2&quot;)
2

julia&gt; num_electrons(rc&quot;[Kr] 5s2 5p-2 5p2&quot;)
42</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L578-L590">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.num_electrons-Tuple{Configuration, AbstractOrbital}" href="#AtomicLevels.num_electrons-Tuple{Configuration, AbstractOrbital}"><code>AtomicLevels.num_electrons</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">num_electrons(c::Configuration, o::AbstractOrbital) -&gt; Int</code></pre><p>Returns the number of electrons on orbital <code>o</code> in configuration <code>c</code>. If <code>o</code> is not part of the configuration, returns <code>0</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; num_electrons(c&quot;1s 2s2&quot;, o&quot;2s&quot;)
2

julia&gt; num_electrons(rc&quot;[Rn] Qf-5 Pf3&quot;, ro&quot;Qf-&quot;)
5

julia&gt; num_electrons(c&quot;[Ne]&quot;, o&quot;3s&quot;)
0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L593-L609">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.orbitals-Tuple{Configuration}" href="#AtomicLevels.orbitals-Tuple{Configuration}"><code>AtomicLevels.orbitals</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">orbitals(c::Configuration{O}) -&gt; Vector{O}</code></pre><p>Access the underlying list of orbitals</p><pre><code class="language-julia-repl hljs">julia&gt; orbitals(c&quot;1s2 2s2&quot;)
2-element Vector{Orbital{Int64}}:
 1s
 2s

julia&gt; orbitals(rc&quot;1s2 2p-2&quot;)
2-element Vector{RelativisticOrbital{Int64}}:
 1s
 2p-</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L632-L648">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.delete!" href="#Base.delete!"><code>Base.delete!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">delete!(c::Configuration, o::AbstractOrbital)</code></pre><p>Remove the entire subshell corresponding to orbital <code>o</code> from configuration <code>c</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; delete!(c&quot;[Ar] 4s2 3d10 4p2&quot;, o&quot;4s&quot;)
[Ar]ᶜ 3d¹⁰ 4p²</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L884-L893">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+" href="#Base.:+"><code>Base.:+</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">+(::Configuration, ::Configuration)</code></pre><p>Add two configurations together. If both configuration have an orbital, the number of electrons gets added together, but in this case the status of the orbitals must match.</p><pre><code class="language-julia-repl hljs">julia&gt; c&quot;1s&quot; + c&quot;2s&quot;
1s 2s

julia&gt; c&quot;1s&quot; + c&quot;1s&quot;
1s²</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L851-L864">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:-" href="#Base.:-"><code>Base.:-</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">-(configuration::Configuration, orbital::AbstractOrbital[, n=1])</code></pre><p>Remove <code>n</code> electrons in the orbital <code>orbital</code> from the configuration <code>configuration</code>. If the orbital had previously been <code>:closed</code> or <code>:inactive</code>, it will now be <code>:open</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L821-L827">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.close" href="#Base.close"><code>Base.close</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">close(c::Configuration)</code></pre><p>Return a corresponding configuration where where all the orbitals are marked <code>:closed</code>.</p><p>See also: <a href="#AtomicLevels.close!"><code>close!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L219-L225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.close!" href="#AtomicLevels.close!"><code>AtomicLevels.close!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">close!(c::Configuration)</code></pre><p>Marks all the orbitals in configuration <code>c</code> as closed.</p><p>See also: <a href="#Base.close"><code>close</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L228-L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.fill" href="#Base.fill"><code>Base.fill</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fill(c::Configuration)</code></pre><p>Returns a corresponding configuration where the orbitals are completely filled (as determined by <a href="../orbitals/#AtomicLevels.degeneracy"><code>degeneracy</code></a>).</p><p>See also: <a href="#Base.fill!"><code>fill!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L196-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.fill!" href="#Base.fill!"><code>Base.fill!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fill!(c::Configuration)</code></pre><p>Sets all the occupancies in configuration <code>c</code> to maximum, as determined by the <a href="../orbitals/#AtomicLevels.degeneracy"><code>degeneracy</code></a> function.</p><p>See also: <a href="#Base.fill"><code>fill</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L206-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.in" href="#Base.in"><code>Base.in</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">in(o::AbstractOrbital, c::Configuration) -&gt; Bool</code></pre><p>Checks if orbital <code>o</code> is part of configuration <code>c</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; in(o&quot;2s&quot;, c&quot;1s2 2s2&quot;)
true

julia&gt; o&quot;2p&quot; ∈ c&quot;1s2 2s2&quot;
false</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L616-L628">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.filter" href="#Base.filter"><code>Base.filter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">filter(f, c::Configuration) -&gt; Configuration</code></pre><p>Filter out the orbitals from configuration <code>c</code> for which the predicate <code>f</code> returns <code>false</code>. The predicate <code>f</code> needs to take three arguments: <code>orbital</code>, <code>occupancy</code> and <code>state</code>.</p><pre><code class="language-julia hljs">julia&gt; filter((o,occ,s) -&gt; o.ℓ == 1, c&quot;[Kr]&quot;)
2p⁶ᶜ 3p⁶ᶜ 4p⁶ᶜ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L651-L661">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.replace" href="#Base.replace"><code>Base.replace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">replace(conf, a =&gt; b[; append=false])</code></pre><p>Substitute one electron in orbital <code>a</code> of <code>conf</code> by one electron in orbital <code>b</code>. If <code>conf</code> is unsorted the substitution is performed in-place, unless <code>append</code>, in which case the new orbital is appended instead.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; replace(c&quot;1s2 2s&quot;, o&quot;1s&quot; =&gt; o&quot;2p&quot;)
1s 2p 2s

julia&gt; replace(c&quot;1s2 2s&quot;, o&quot;1s&quot; =&gt; o&quot;2p&quot;, append=true)
1s 2s 2p

julia&gt; replace(c&quot;1s2 2s&quot;s, o&quot;1s&quot; =&gt; o&quot;2p&quot;)
1s 2s 2p</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L767-L787">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.core" href="#AtomicLevels.core"><code>AtomicLevels.core</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">core(::Configuration) -&gt; Configuration</code></pre><p>Return the core configuration (i.e. the sub-configuration of all the orbitals that are marked <code>:closed</code>).</p><pre><code class="language-julia-repl hljs">julia&gt; core(c&quot;1s2c 2s2c 2p6c 3s2&quot;)
[Ne]ᶜ

julia&gt; core(c&quot;1s2 2s2&quot;)
∅

julia&gt; core(c&quot;1s2 2s2c 2p6c&quot;)
2s²ᶜ 2p⁶ᶜ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L665-L681">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.peel" href="#AtomicLevels.peel"><code>AtomicLevels.peel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">peel(::Configuration) -&gt; Configuration</code></pre><p>Return the non-core part of the configuration (i.e. orbitals not marked <code>:closed</code>).</p><pre><code class="language-julia-repl hljs">julia&gt; peel(c&quot;1s2c 2s2c 2p3&quot;)
2p³

julia&gt; peel(c&quot;[Ne] 3s 3p3&quot;)
3s 3p³</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L684-L696">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.active" href="#AtomicLevels.active"><code>AtomicLevels.active</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">active(::Configuration) -&gt; Configuration</code></pre><p>Return the part of the configuration marked <code>:open</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; active(c&quot;1s2c 2s2i 2p3i 3s2&quot;)
3s²</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L711-L720">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.inactive" href="#AtomicLevels.inactive"><code>AtomicLevels.inactive</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">inactive(::Configuration) -&gt; Configuration</code></pre><p>Return the part of the configuration marked <code>:inactive</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; inactive(c&quot;1s2c 2s2i 2p3i 3s2&quot;)
2s²ⁱ 2p³ⁱ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L699-L708">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.bound" href="#AtomicLevels.bound"><code>AtomicLevels.bound</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bound(::Configuration) -&gt; Configuration</code></pre><p>Return the bound part of the configuration (see also <a href="../orbitals/#AtomicLevels.isbound"><code>isbound</code></a>).</p><pre><code class="language-julia-repl hljs">julia&gt; bound(c&quot;1s2 2s2 2p4 Ks2 Kp1&quot;)
1s² 2s² 2p⁴</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L723-L732">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.continuum" href="#AtomicLevels.continuum"><code>AtomicLevels.continuum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">continuum(::Configuration) -&gt; Configuration</code></pre><p>Return the non-bound (continuum) part of the configuration (see also <a href="../orbitals/#AtomicLevels.isbound"><code>isbound</code></a>).</p><pre><code class="language-julia-repl hljs">julia&gt; continuum(c&quot;1s2 2s2 2p4 Ks2 Kp1&quot;)
Ks² Kp</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L735-L744">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.parity-Tuple{Configuration}" href="#AtomicLevels.parity-Tuple{Configuration}"><code>AtomicLevels.parity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">parity(::Configuration) -&gt; Parity</code></pre><p>Return the parity of the configuration.</p><pre><code class="language-julia-repl hljs">julia&gt; parity(c&quot;1s 2p&quot;)
odd

julia&gt; parity(c&quot;1s 2p2&quot;)
even</code></pre><p>See also: <a href="../utilities/#Parity"><code>Parity</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L750-L764">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.nonrelconfiguration" href="#AtomicLevels.nonrelconfiguration"><code>AtomicLevels.nonrelconfiguration</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nonrelconfiguration(c::Configuration{&lt;:RelativisticOrbital}) -&gt; Configuration{&lt;:Orbital}</code></pre><p>Reduces a relativistic configuration down to the corresponding non-relativistic configuration.</p><pre><code class="language-julia-repl hljs">julia&gt; c = rc&quot;1s2 2p-2 2s 2p2 3s2 3p-&quot;s
1s² 2s 2p-² 2p² 3s² 3p-

julia&gt; nonrelconfiguration(c)
1s² 2s 2p⁴ 3s² 3p</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1288-L1300">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.relconfigurations" href="#AtomicLevels.relconfigurations"><code>AtomicLevels.relconfigurations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">relconfigurations(c::Configuration{&lt;:Orbital}) -&gt; Vector{&lt;:Configuration{&lt;:RelativisticOrbital}}</code></pre><p>Generate all relativistic configurations from the non-relativistic configuration <code>c</code>, by applying <a href="../internals/#AtomicLevels.rconfigurations_from_orbital-Tuple{Orbital, Integer}"><code>rconfigurations_from_orbital</code></a> to each subshell and combining the results.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1003-L1009">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.multiplicity-Tuple{Configuration}" href="#AtomicLevels.multiplicity-Tuple{Configuration}"><code>AtomicLevels.multiplicity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">multiplicity(::Configuration)</code></pre><p>Calculates the number of Slater determinants corresponding to the configuration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1319-L1323">source</a></section></article><h2 id="Generating-configuration-lists"><a class="docs-heading-anchor" href="#Generating-configuration-lists">Generating configuration lists</a><a id="Generating-configuration-lists-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-configuration-lists" title="Permalink"></a></h2><p>The <a href="#AtomicLevels.:⊗"><code>⊗</code></a> operator can be used to easily generate lists of configurations from existing pieces. E.g. to create all the valence configurations on top of an closed core, you only need to write</p><pre><code class="language-julia-repl hljs">julia&gt; c&quot;[Ne]&quot; ⊗ [c&quot;3s2&quot;, c&quot;3s 3p&quot;, c&quot;3p2&quot;]
3-element Vector{Configuration{Orbital{Int64}}}:
 [Ne]ᶜ 3s²
 [Ne]ᶜ 3s 3p
 [Ne]ᶜ 3p²</code></pre><p>That can be combined with the <a href="#AtomicLevels.@rcs_str"><code>@rcs_str</code></a> string macro to easily generate all possible relativistic configurations from a non-relativistic definition:</p><pre><code class="language-julia-repl hljs">julia&gt; rc&quot;[Ne] 3s2&quot; ⊗ rcs&quot;3p2&quot;
3-element Vector{Configuration{RelativisticOrbital{Int64}}}:
 [Ne]ᶜ 3s² 3p-²
 [Ne]ᶜ 3s² 3p- 3p
 [Ne]ᶜ 3s² 3p²</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.:⊗" href="#AtomicLevels.:⊗"><code>AtomicLevels.:⊗</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">⊗(::Union{Configuration, Vector{Configuration}}, ::Union{Configuration, Vector{Configuration}})</code></pre><p>Given two collections of <code>Configuration</code>s, it creates an array of <code>Configuration</code>s with all possible juxtapositions of configurations from each collection.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; c&quot;1s&quot; ⊗ [c&quot;2s2&quot;, c&quot;2s 2p&quot;]
2-element Vector{Configuration{Orbital{Int64}}}:
 1s 2s²
 1s 2s 2p

julia&gt; [rc&quot;1s&quot;, rc&quot;2s&quot;] ⊗ [rc&quot;2p-&quot;, rc&quot;2p&quot;]
4-element Vector{Configuration{RelativisticOrbital{Int64}}}:
 1s 2p-
 1s 2p
 2s 2p-
 2s 2p</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L903-L924">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.@rcs_str" href="#AtomicLevels.@rcs_str"><code>AtomicLevels.@rcs_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@rcs_str -&gt; Vector{Configuration{RelativisticOrbital}}</code></pre><p>Construct a <code>Vector</code> of all <code>Configuration</code>s corresponding to the non-relativistic <code>nℓ</code> orbital with the given occupancy from the input string.</p><p>The string is assumed to have the following syntax: <code>$(n)$(ℓ)$(occupancy)</code>, where <code>n</code> and <code>occupancy</code> are integers, and <code>ℓ</code> is in spectroscopic notation.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; rcs&quot;3p2&quot;
3-element Vector{Configuration{&lt;:RelativisticOrbital}}:
 3p-²
 3p- 3p
 3p²</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1029-L1047">source</a></section></article><h2 id="Spin-configurations"><a class="docs-heading-anchor" href="#Spin-configurations">Spin configurations</a><a id="Spin-configurations-1"></a><a class="docs-heading-anchor-permalink" href="#Spin-configurations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.SpinConfiguration" href="#AtomicLevels.SpinConfiguration"><code>AtomicLevels.SpinConfiguration</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SpinConfiguration</code></pre><p>Specialization of <a href="#AtomicLevels.Configuration"><code>Configuration</code></a> for configurations consisting of <a href="../orbitals/#AtomicLevels.SpinOrbital"><code>SpinOrbital</code></a>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1118-L1123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.spin_configurations" href="#AtomicLevels.spin_configurations"><code>AtomicLevels.spin_configurations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spin_configurations(configuration)</code></pre><p>Generate all possible configurations of spin-orbitals from <code>configuration</code>, i.e. all permissible values for the quantum numbers <code>n</code>, <code>ℓ</code>, <code>mℓ</code>, <code>ms</code> for each electron. Example:</p><pre><code class="language-julia-repl hljs">julia&gt; spin_configurations(c&quot;1s2&quot;)
1-element Vector{SpinConfiguration{SpinOrbital{Orbital{Int64}, Tuple{Int64, HalfIntegers.Half{Int64}}}}}:
 1s₀α 1s₀β

julia&gt; spin_configurations(c&quot;1s2&quot;s)
1-element Vector{SpinConfiguration{SpinOrbital{Orbital{Int64}, Tuple{Int64, HalfIntegers.Half{Int64}}}}}:
 1s₀α 1s₀β

julia&gt; spin_configurations(c&quot;1s ks&quot;)
4-element Vector{SpinConfiguration{SpinOrbital{&lt;:Orbital, Tuple{Int64, HalfIntegers.Half{Int64}}}}}:
 1s₀α ks₀α
 1s₀β ks₀α
 1s₀α ks₀β
 1s₀β ks₀β</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1053-L1075">source</a></section><section><div><pre><code class="language-julia hljs">spin_configurations(configurations)</code></pre><p>For each configuration in <code>configurations</code>, generate all possible configurations of spin-orbitals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1107-L1112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.substitutions" href="#AtomicLevels.substitutions"><code>AtomicLevels.substitutions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">substitutions(src::SpinConfiguration, dst::SpinConfiguration)</code></pre><p>Find all orbital substitutions going from spin-configuration <code>src</code> to configuration <code>dst</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1234-L1239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.@sc_str" href="#AtomicLevels.@sc_str"><code>AtomicLevels.@sc_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@sc_str -&gt; SpinConfiguration{&lt;:SpinOrbital{&lt;:Orbital}}</code></pre><p>A string macro to construct a non-relativistic <a href="#AtomicLevels.SpinConfiguration"><code>SpinConfiguration</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; sc&quot;1s₀α 2p₋₁β&quot;
1s₀α 2p₋₁β

julia&gt; sc&quot;ks(0,-1/2) l[4](-3,1/2)&quot;
ks₀β lg₋₃α</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1149-L1163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.@rsc_str" href="#AtomicLevels.@rsc_str"><code>AtomicLevels.@rsc_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@rsc_str -&gt; SpinConfiguration{&lt;:SpinOrbital{&lt;:RelativisticOrbital}}</code></pre><p>A string macro to construct a relativistic <a href="#AtomicLevels.SpinConfiguration"><code>SpinConfiguration</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; rsc&quot;1s(1/2) 2p(-1/2)&quot;
1s(1/2) 2p(-1/2)

julia&gt; rsc&quot;ks(-1/2) l[4]-(-5/2)&quot;
ks(-1/2) lg-(-5/2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L1168-L1182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.@scs_str" href="#AtomicLevels.@scs_str"><code>AtomicLevels.@scs_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@scs_str -&gt; Vector{&lt;:SpinConfiguration{&lt;:Orbital}}</code></pre><p>Generate all possible spin-configurations out of a string. With the added string macro suffix <code>s</code>, the configuration is sorted.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; scs&quot;1s2 2p2&quot;
15-element Vector{SpinConfiguration{SpinOrbital{Orbital{Int64}, Tuple{Int64, HalfIntegers.Half{Int64}}}}}:
 1s₀α 1s₀β 2p₋₁α 2p₋₁β
 1s₀α 1s₀β 2p₋₁α 2p₀α
 1s₀α 1s₀β 2p₋₁α 2p₀β
 1s₀α 1s₀β 2p₋₁α 2p₁α
 1s₀α 1s₀β 2p₋₁α 2p₁β
 1s₀α 1s₀β 2p₋₁β 2p₀α
 1s₀α 1s₀β 2p₋₁β 2p₀β
 1s₀α 1s₀β 2p₋₁β 2p₁α
 1s₀α 1s₀β 2p₋₁β 2p₁β
 1s₀α 1s₀β 2p₀α 2p₀β
 1s₀α 1s₀β 2p₀α 2p₁α
 1s₀α 1s₀β 2p₀α 2p₁β
 1s₀α 1s₀β 2p₀β 2p₁α
 1s₀α 1s₀β 2p₀β 2p₁β
 1s₀α 1s₀β 2p₁α 2p₁β</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L435-L462">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.@rscs_str" href="#AtomicLevels.@rscs_str"><code>AtomicLevels.@rscs_str</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@rscs_str -&gt; Vector{&lt;:SpinConfiguration{&lt;:RelativisticOrbital}}</code></pre><p>Generate all possible relativistic spin-configurations out of a string. With the added string macro suffix <code>s</code>, the configuration is sorted.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; rscs&quot;1s2 2p2&quot;
6-element Vector{SpinConfiguration{SpinOrbital{RelativisticOrbital{Int64}, Tuple{HalfIntegers.Half{Int64}}}}}:
 1s(-1/2) 1s(1/2) 2p(-3/2) 2p(-1/2)
 1s(-1/2) 1s(1/2) 2p(-3/2) 2p(1/2)
 1s(-1/2) 1s(1/2) 2p(-3/2) 2p(3/2)
 1s(-1/2) 1s(1/2) 2p(-1/2) 2p(1/2)
 1s(-1/2) 1s(1/2) 2p(-1/2) 2p(3/2)
 1s(-1/2) 1s(1/2) 2p(1/2) 2p(3/2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/configurations.jl#L467-L486">source</a></section></article><h2 id="Excited-configurations"><a class="docs-heading-anchor" href="#Excited-configurations">Excited configurations</a><a id="Excited-configurations-1"></a><a class="docs-heading-anchor-permalink" href="#Excited-configurations" title="Permalink"></a></h2><p>AtomicLevels.jl provides an easy interface for generating lists of configurations which are the result of exciting one or more orbitals of a reference set to a set of substitution orbitals. This is done with <a href="#AtomicLevels.excited_configurations"><code>excited_configurations</code></a>, which provides various parameters for controlling which excitations are generated. A very simple example could be</p><pre><code class="language-julia-repl hljs">julia&gt; excited_configurations(c&quot;1s2&quot;, os&quot;2[s-p]&quot;...)
4-element Vector{Configuration{Orbital{Int64}}}:
 1s²
 1s 2s
 2s²
 2p²</code></pre><p>which as we see contains all configurations generated by at most exciting two orbitals <code>1s²</code> and keeping the overall parity. By lifting these restrictions, more configurations can be generated:</p><pre><code class="language-julia-repl hljs">julia&gt; excited_configurations(c&quot;1s2 2s&quot;, os&quot;3[s-p]&quot;...,
                              keep_parity=false, max_excitations=2)
14-element Vector{Configuration{Orbital{Int64}}}:
 1s² 2s
 1s 2s²
 1s 2s 3s
 1s 2s 3p
 1s² 3s
 1s² 3p
 2s² 3s
 2s² 3p
 2s 3s²
 2s 3s 3p
 1s 3s²
 1s 3s 3p
 2s 3p²
 1s 3p²

julia&gt; excited_configurations(c&quot;1s2 2s&quot;, os&quot;3[s-p]&quot;...,
                              keep_parity=false, max_excitations=3)
17-element Vector{Configuration{Orbital{Int64}}}:
 1s² 2s
 1s 2s²
 1s 2s 3s
 1s 2s 3p
 1s² 3s
 1s² 3p
 2s² 3s
 2s² 3p
 2s 3s²
 2s 3s 3p
 1s 3s²
 1s 3s 3p
 2s 3p²
 1s 3p²
 3s² 3p
 3s 3p²
 3p³</code></pre><p>Since configurations by default are unsorted, when exciting from <a href="#AtomicLevels.SpinConfiguration"><code>SpinConfiguration</code></a>s, the substitutions are performed in-place:</p><pre><code class="language-julia-repl hljs">julia&gt; excited_configurations(first(scs&quot;1s2&quot;), sos&quot;2[s-p]&quot;...)
21-element Vector{SpinConfiguration{SpinOrbital{Orbital{Int64}, Tuple{Int64, HalfIntegers.Half{Int64}}}}}:
 1s₀α 1s₀β
 2s₀α 1s₀β
 2s₀β 1s₀β
 1s₀α 2s₀α
 1s₀α 2s₀β
 2s₀α 2s₀β
 2p₋₁α 2p₋₁β
 2p₋₁α 2p₀α
 2p₋₁α 2p₀β
 2p₋₁α 2p₁α
 ⋮
 2p₋₁β 2p₀β
 2p₋₁β 2p₁α
 2p₋₁β 2p₁β
 2p₀α 2p₀β
 2p₀α 2p₁α
 2p₀α 2p₁β
 2p₀β 2p₁α
 2p₀β 2p₁β
 2p₁α 2p₁β</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AtomicLevels.excited_configurations" href="#AtomicLevels.excited_configurations"><code>AtomicLevels.excited_configurations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">excited_configurations([fun::Function, ] cfg::Configuration,
                       orbitals::AbstractOrbital...
                       [; min_excitations=0, max_excitations=:doubles,
                        min_occupancy=[0, 0, ...], max_occupancy=[..., g_i, ...],
                        keep_parity=true])</code></pre><p>Generate all excitations from the reference set <code>cfg</code> by substituting at least <code>min_excitations</code> and at most <code>max_excitations</code> of the substitution <code>orbitals</code>. <code>min_occupancy</code> specifies the minimum occupation number for each of the source orbitals (default <code>0</code>) and equivalently <code>max_occupancy</code> specifies the maximum occupation number (default is the degeneracy for each orbital). <code>keep_parity</code> controls whether the excited configuration has to have the same parity as <code>cfg</code>. Finally, <code>fun</code> allows modification of the substitution orbitals depending on the source orbitals, which is useful for generating ionized configurations. If <code>fun</code> returns <code>nothing</code>, that particular substitution will be rejected.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; excited_configurations(c&quot;1s2&quot;, o&quot;2s&quot;, o&quot;2p&quot;)
4-element Vector{Configuration{Orbital{Int64}}}:
 1s²
 1s 2s
 2s²
 2p²

julia&gt; excited_configurations(c&quot;1s2 2p&quot;, o&quot;2p&quot;)
2-element Vector{Configuration{Orbital{Int64}}}:
 1s² 2p
 2p³

julia&gt; excited_configurations(c&quot;1s2 2p&quot;, o&quot;2p&quot;, max_occupancy=[2,2])
1-element Vector{Configuration{Orbital{Int64}}}:
 1s² 2p

julia&gt; excited_configurations(first(scs&quot;1s2&quot;), sos&quot;k[s]&quot;...) do dst,src
           if isbound(src)
               # Generate label that indicates src orbital,
               # i.e. the resultant hole
               SpinOrbital(Orbital(Symbol(&quot;[$(src)]&quot;), dst.orb.ℓ), dst.m)
           else
               dst
           end
       end
9-element Vector{SpinConfiguration{SpinOrbital{&lt;:Orbital, Tuple{Int64, HalfIntegers.Half{Int64}}}}}:
 1s₀α 1s₀β
 [1s₀α]s₀α 1s₀β
 [1s₀α]s₀β 1s₀β
 1s₀α [1s₀β]s₀α
 1s₀α [1s₀β]s₀β
 [1s₀α]s₀α [1s₀β]s₀α
 [1s₀α]s₀β [1s₀β]s₀α
 [1s₀α]s₀α [1s₀β]s₀β
 [1s₀α]s₀β [1s₀β]s₀β

julia&gt; excited_configurations((a,b) -&gt; a.m == b.m ? a : nothing,
                              spin_configurations(c&quot;1s&quot;), sos&quot;k[s-d]&quot;..., keep_parity=false)
8-element Vector{SpinConfiguration{SpinOrbital{&lt;:Orbital, Tuple{Int64, HalfIntegers.Half{Int64}}}}}:
 1s₀α
 ks₀α
 kp₀α
 kd₀α
 1s₀β
 ks₀β
 kp₀β
 kd₀β</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/AtomicLevels.jl/blob/5377bf7e472614e36357a7b8c5bedbaa8a965bca/src/excited_configurations.jl#L166-L236">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#AtomicLevels.Configuration"><code>AtomicLevels.Configuration</code></a></li><li><a href="#AtomicLevels.SpinConfiguration"><code>AtomicLevels.SpinConfiguration</code></a></li><li><a href="#AtomicLevels.:⊗"><code>AtomicLevels.:⊗</code></a></li><li><a href="#AtomicLevels.active"><code>AtomicLevels.active</code></a></li><li><a href="#AtomicLevels.bound"><code>AtomicLevels.bound</code></a></li><li><a href="#AtomicLevels.close!"><code>AtomicLevels.close!</code></a></li><li><a href="#AtomicLevels.continuum"><code>AtomicLevels.continuum</code></a></li><li><a href="#AtomicLevels.core"><code>AtomicLevels.core</code></a></li><li><a href="#AtomicLevels.excited_configurations"><code>AtomicLevels.excited_configurations</code></a></li><li><a href="#AtomicLevels.inactive"><code>AtomicLevels.inactive</code></a></li><li><a href="#AtomicLevels.issimilar"><code>AtomicLevels.issimilar</code></a></li><li><a href="#AtomicLevels.multiplicity-Tuple{Configuration}"><code>AtomicLevels.multiplicity</code></a></li><li><a href="#AtomicLevels.nonrelconfiguration"><code>AtomicLevels.nonrelconfiguration</code></a></li><li><a href="#AtomicLevels.num_electrons-Tuple{Configuration, AbstractOrbital}"><code>AtomicLevels.num_electrons</code></a></li><li><a href="#AtomicLevels.num_electrons-Tuple{Configuration}"><code>AtomicLevels.num_electrons</code></a></li><li><a href="#AtomicLevels.orbitals-Tuple{Configuration}"><code>AtomicLevels.orbitals</code></a></li><li><a href="#AtomicLevels.parity-Tuple{Configuration}"><code>AtomicLevels.parity</code></a></li><li><a href="#AtomicLevels.peel"><code>AtomicLevels.peel</code></a></li><li><a href="#AtomicLevels.relconfigurations"><code>AtomicLevels.relconfigurations</code></a></li><li><a href="#AtomicLevels.spin_configurations"><code>AtomicLevels.spin_configurations</code></a></li><li><a href="#AtomicLevels.substitutions"><code>AtomicLevels.substitutions</code></a></li><li><a href="#Base.:+"><code>Base.:+</code></a></li><li><a href="#Base.:-"><code>Base.:-</code></a></li><li><a href="#Base.:==-Union{Tuple{O}, Tuple{Configuration{&lt;:O}, Configuration{&lt;:O}}} where O&lt;:AbstractOrbital"><code>Base.:==</code></a></li><li><a href="#Base.close"><code>Base.close</code></a></li><li><a href="#Base.delete!"><code>Base.delete!</code></a></li><li><a href="#Base.fill"><code>Base.fill</code></a></li><li><a href="#Base.fill!"><code>Base.fill!</code></a></li><li><a href="#Base.filter"><code>Base.filter</code></a></li><li><a href="#Base.in"><code>Base.in</code></a></li><li><a href="#Base.replace"><code>Base.replace</code></a></li><li><a href="#AtomicLevels.@c_str"><code>AtomicLevels.@c_str</code></a></li><li><a href="#AtomicLevels.@rc_str"><code>AtomicLevels.@rc_str</code></a></li><li><a href="#AtomicLevels.@rcs_str"><code>AtomicLevels.@rcs_str</code></a></li><li><a href="#AtomicLevels.@rsc_str"><code>AtomicLevels.@rsc_str</code></a></li><li><a href="#AtomicLevels.@rscs_str"><code>AtomicLevels.@rscs_str</code></a></li><li><a href="#AtomicLevels.@sc_str"><code>AtomicLevels.@sc_str</code></a></li><li><a href="#AtomicLevels.@scs_str"><code>AtomicLevels.@scs_str</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../orbitals/">« Orbitals</a><a class="docs-footer-nextpage" href="../terms/">Term symbols »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Monday 22 April 2024 10:44">Monday 22 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
